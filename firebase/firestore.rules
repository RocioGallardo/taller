rules_version = '2';
service cloud.firestore { 
  match /databases/{database}/documents {
    match /clientes/{clienteId} {
      allow read, write: if isDev();
    }

    match /presupuestos/{presupuestoId} {
      allow read, write: if isDev();
    }

    match /presupuestos/{presupuestoId}/items/{itemId} {
      allow read, write: if isDev();
    }

    match /gastos/{gastoId} {
      allow read, write: if isDev();
    }

    match /pagosSueldos/{pagoId} {
      allow read, write: if isDev();
    }

    match /configuracion/{docId} {
      allow read, write: if isDev();
    }
  }

  function isSignedIn() {
    return request.auth != null;
  }

  function hasRole(role) {
    return role in request.auth.token.roles;
  }

  function isAdmin() {
    return isSignedIn() && hasRole('admin');
  }

  function isStaff() {
    return isSignedIn() && (hasRole('admin') || hasRole('operador'));
  }

  function isDev() {
    return true;
  }
}

